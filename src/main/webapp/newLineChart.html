<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <script src="js/echarts.js"></script>
    <script src="ref/others/jquery.min.js"></script>
    <title>Title</title>
</head>
<body>
<!-- 为ECharts准备一个具备大小（宽高）的Dom -->
<div id="main" style="width: 600px;height:400px;"></div>
<script type="text/javascript">
    // 基于准备好的dom，初始化echarts实例
    var myChart = echarts.init(document.getElementById('main'));


    var url = "/jikeng/GetCurrentData";
    var date = "2015-03-02";
    var modelName = "jikeng1";
    var iData =  "date="+date+"&modelName="+modelName;

    $.ajax({
        type:"post",
        url:url,
        cache:false,
        dataType: "jsonp", // 跨域请求需要使用jsonp
        data:iData,
        jsonp: "jsonpCallback",
        jsonpCallback: "jsonpCallback",
        success: function (data) {
//            console.log("getcurrentdata:"+data);
            values = new Array();
            sensorId = new Array();
            depth = new Array();
            for(var i = 0; i<data.length;i++){
                if(typeof(values[data[i].sensorId-1]) == "undefined"){
                    values[data[i].sensorId-1] = new Array();
                    sensorId.push("sensor"+data[i].sensorId);
                }
                values[data[i].sensorId-1][data[i].depth] = data[i].value;
            }
            for(var i = 0;i<values[0].length;i++){
                depth.push(i);
            }
            console.log("values is: "+values);
            options = {
                title: {
                    text: date+" "+modelName+'传感器数据图'
                },
                tooltip : {
                    trigger: 'axis',
                    axisPointer: {
                        type: 'cross',
                        label: {
                            backgroundColor: '#6a7985'
                        }
                    }
                },
//                legend: {
//                    data:sensorId
//                },
                toolbox: {
                    feature: {
                        saveAsImage: {}
                    }
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    containLabel: true
                },
                xAxis : [
                    {
                        type : 'category',
                        boundaryGap : false,
                        data : depth
                    }
                ],
                yAxis : [
                    {
                        type : 'value'
                    }
                ]
            };
            options["series"] = new Array();
            for(var i = 0; i<sensorId.length;i++){
                var d = {
                    name:sensorId[i],
                        type:'line',
                    stack: '总量',
                    areaStyle: {normal: {}},
                    data:values[i]
                };
                options["series"].push(d);
            }
            console.log(options);
            myChart.setOption(options);

        },
        error: function () {
            console.log("GetCurrentData error!");
        }
    });

</script>

</body>
</html>